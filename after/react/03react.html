<!DOCTYPE html>
<html>
  <head>
    <title>
    React 3.0
  </title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
      <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
      <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>

      <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  
  <body>
    
    <h1>lesson 3</h1>
    <div class="js-main">

    <script type = 'text/babel'>

      function ChatTop({chatMessages, setChatMessages}){
        const [inputText, setInputText] = React.useState('')
        
        function saveInputText(event){
          setInputText(event.target.value);
        };

        function sendMessage(){
          setChatMessages([
            //spread operator copies preexisting values
            ...chatMessages, 
            {
              message : inputText,
              sender : 'user',
              id : crypto.randomUUID()
            }
           ]);

          const response = Chatbot.getResponse(inputText);

           setInputText('');
        };
        return(
          <>
            <p>Welcome to the Chatbot</p>
            <input 
              type="text" 
              onChange = {saveInputText}
              value = {inputText}
            />
            <button onClick = {sendMessage}
            
            >Send</button>
          </>
        );
      };
      
      function ChatMessages({message, sender}){
        return(
          <div>
            
            {sender === 'robot' && <button>robot</button>}

            {message}

            {sender === 'user' && <button>user</button> }
          </div>
        );
      };
      
      function ChatMessage({chatMessages}){
     

        /*
          function sendMessage(){
           setChatMessages([
            //spread operator copies preexisting values
            ...chatMessages, 
            {
              message : 'test',
              sender : 'user',
              id : crypto.randomUUID()
            }
           ]);
          };
          */
        return (
          <>
       


            {chatMessages.map((chatMessage) => {
              return(
                <ChatMessages 
                  message = {chatMessage.message}
                  sender = {chatMessage.sender}
                  key = {chatMessage.key}
                />
              );
                })}
          </>
          );
      };
      

      function App(){
           const [chatMessages, setChatMessages] = React.useState([
          {
            message : 'Hello',
            sender : 'robot',
            key : 'id01'
          }, {
            message : 'Hiii',
            sender : 'user',
            key : 'id02'
          }, {
            sender : 'robot',
            message : 'How may I help you?',
            key : 'id03'
          }
        ]);
    
        //const chatMessages = array[0];
        //const setChatMessages = array[1];

        return(
          <>
            <ChatTop 
              chatMessages = {chatMessages}
              setChatMessages = {setChatMessages}
            />
            <ChatMessage 
              chatMessages = {chatMessages}
            />
          </>
        );
      };
     const container = document.querySelector('.js-main');
     const reactRoot = ReactDOM.createRoot(container); 
     reactRoot.render(<App />);
    </script>
  </body>
</html>